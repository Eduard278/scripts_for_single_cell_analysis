Mammary T cells (CD45+CD90.2+, TCRb+ PLACEHOLDER) from nulliparous,  pregnant (G18.5), and lactating (L5) mice were sorted from samples labeled with TotalSeqC hashtags antibodies (Biolegend) using a Sony MA900 sorter. Sorted cells were pooled and PLACEHOLDER cells per lane (total of p lanes) were loaded on a Chromium Single Cell Controller (10X Genomics) to encapsulate the cells into droplets. The gene expression (GEX),  hashtag oligonucleotide (HTO) and VDJ (TCR) sequencing libraries were prepared using Chromium Single Cell 5’ v2 reagent kits following the manufacturer’s instructions, and sequenced on an Illumina Nextseq1000 platform (NextSeq 1000/2000 P2 reagents (100 cycles)).
The initial processing of the expression data involved generating fastq files and count matrices using Cell Ranger (57) v7.1.0 (10X Genomics, Pleasanton, CA) that was run with the “Include introns=True” option and the mm10-2020-A transcriptome reference, whereas the TCR data was processed with Cell Ranger v7.1.0 using a VDJ reference based on the IGMT database. The IGMT database were generated with Cell Ranger v7.1.0 using the 'fetch-imgt' and 'cellranger mkvdjref' functions. Processing of the expression data was performed with the 'cellranger multi' and 'cellranger aggr' functions. After processing and aggregation, the estimated number of cells and mean reads per cell for each library were as follows: 114629 estimated number of cells, 21832 mean reads per cell (from eight GEX libraries), 543 Median hashtag UMIs per Cell (across eight HTO libraries), 66544 cells with a productive V-J spanning TRA and TRB pair (from eight VDJ libraries).

The overall sequencing quality was high in the eight mRNA libraries with >94% of bases in the barcode and UMI regions had Q30 (99.99% inferred base call accuracy) quality score or above, whereas >90% of bases in the RNA reads had Q30 or above. Furthermore, the median gene count range was 564-955 along with a sequencing saturation range of 63-71%, and 68-71% of the reads mapped confidently to the transcriptome. Across the eight TCR libraries, the mean used reads per cell was 191-919 (average 655). Across the eight hashtag (HTO) libraries the mean antibody reads usable per cell was 161-945 (average 635).

In the downstream analysis of the expression data, the Cell Ranger aggregation output (filtered_feature_bc_matrix directory) was loaded into Seurat version 4.4.1 (58) using the CreateSeuratObject function with min.cells=3 and min.features = 200 settings, that retained the genes detected in at least 100 cells with at least 200 genes detected per cell. For filtering out the low-quality cells, we used the isOutlier function of the R package scuttle (v1.4.0) with nmads (number of median absolute deviations) thresholds of 4 for the highest allowed mitochondrial content (percent. mt), and 3 and 2.5 for the lowest and highest gene and UMI counts (nFeature_RNA and nCount_RNA) allowed, respectively. Log-normalization (LogNormalize function) of the RNA count data and centered log-ratio transformation (CLR) of the HTO count data were carried out using the NormalizeData function. For HTO demultiplexing the cells into the pregnant/lactation groups and removing any additional doublets, HTODemux was run with a positive. quantile = 0.99, whereas FindIntegrationAnchors, IntegrateData, RunPCA, RunUMAP, and FindNeighbors functions of Seurat were run with the top 20 dimensions. 
TCR repertoire sequencing data were analyzed with the scRepertoire package v1.11.0 (59) in R v4.1.1 (R Core Team 2017). Starting with the filtered Cell Ranger contig annotations output, combineTCR and combineExpression functions were used for combining the TCR data from each sample and for integration of the combined TCR data with the single cell RNA-Seq data, respectively. We utilized the amino acid sequence of the paired CDR3 regions of the alpha and beta chains as the clonotype definition, which was used to subset for the cell barcodes mapped to TCR data, which was followed by normalization of the expression data, scaling and PCA analysis using the top 20 principal components. The clusters identified by the FindClusters function of Seurat (default Louvain clustering setting and 0.2 resolution) were further annotated using cell type-specific markers. Finally, the trajectory and gene set signature enrichment analyses at the single cell level were performed with the R packages Slingshot (v2.2.0) (60) and UCell (v1.99.1) (61), respectively. T cell repertoire diversity was estimated using the D50 metric, which was calculated in R as the fraction of clonotypes, ordered by abundance, which account for 50 percent of total TCR sequences (defined as paired aminoacid CDR3 sequences).

For mammary epithelial and myoepithelial scRNA-seq, thymic IELp (CD1d-tetramer–CD4–CD8α–TCRβ+CD5+CD122+H-2Kb+PD-1+) were adoptively transferred (+IELp) or not (-IELp) into pregnant Rag2-/-c-/- /- at day 10.5 of gestation. Mammary epithelial cells and myoepithelial cells (CD45-CD31-EPCAM+) from Rag2-/-c-/- mice with or without IELp were sorted 8 days post-transfer (G18.5) from samples labeled with TotalSeqC hashtags antibodies (Biolegend) with a Sony MA900 sorter. Sorted cells were pooled together and 45,000 cells were loaded to a Chromium Single Cell Controller (10X Genomics) to encapsulate the cells into droplets (1 lanes). The gene expression (GEX) and hashtag oligo (HTO) sequencing libraries were prepared using a Chromium Single Cell 5’ v2 reagent kits following the manufacturer’s instructions and sequenced on an Illumina Nextseq2000 platform (NextSeq 1000/2000 P3 reagents (200 cycles)) with the following total read counts: 269 million (1 GEX library), 47 million (1 HTO library).
Sequencing data was demultiplexed using the bcl-convert tool from llumina and processed using the Cell Ranger (57) (v.7.1.0 (10X Genomics Pleasanton, CA) cellranger multi-function, which was run with the default 'Include-introns=True' option. After running cellranger multi 11230 cells were captured with the following metrics. For the gene expression library: 9987 median reads per cell, 23939 mean reads per cell, 1261 median genes per cell, and 3271 median UMI counts per cell. For the HTO library: 348 median UMI counts per cell, 1096 mean antibody reads usable per cell, 4202 mean reads per cell. The transcriptome reference was mm10-2020-A. Downstream analyses were performed with Seurat v.4.4.0 (Hao2021) with the parameters described below. CreateSeuratObject was run with min.cells=3. Low quality cells were filtered with the following thresholds for gene counts, UMI counts, and percentage mitochondria:  500 < nFeature_RNA < 6000, nCount_RNA < 30000, percent.mt <7, with 6009 cells remaining. The RNA count data was normalized with the LogNormalize method, while the HTO count data was normalized with the CLR method. HTO count data were used to demultiplex mice and to identify doublets (63) with the HTODemux function with the parameter positive.quantile = 0.99. 2400 cells were classified as singlets and used for downstream analyses. FindVariableFeatures (nFeatures=2000) was run, data was scaled with ScaleData,  RunPCA was run (npcs=100) and the top 35 dimensions were used to run FindNeighbors, FindClusters (with a range of resolutions and a final chosen resolution of 0.25), and RunUMAP.The resulting clusters were manually annotated using cell type specific markers. Contaminating clusters comprised of immune, endothelial, and fibroblast cells were removed, while clusters of interest comprised of basal cells, epithelial cells, and putative stem cells were retained. On this subset of cells FindVariableFeatures (nFeatures=2000) was run, data was scaled with ScaleData, RunPCA was run (npcs=100) and the top 28 dimensions were used to run FindNeighbors, FindClusters (with a range of resolutions and a final chosen resolution of 0.6), and RunUMAP. The resulting clusters were manually annotated using cell type specific markers.


